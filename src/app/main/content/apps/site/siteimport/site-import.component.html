<div class="page-layout simple fullwidth" fxLayout="column" fusePerfectScrollbar>

  <!-- HEADER -->
  <div class="header mat-accent-bg p-24 h-100" fxLayout="row" fxLayoutAlign="start center">
    <div fxLayout="column" fxLayoutAlign="center start">
      <div class="h1 mt-16">Site Import</div>
    </div>
  </div>
  <!-- / HEADER -->

  <!-- CONTENT -->
  <div>
    <div>
      <form class="mat-elevation-z4 m-20">
        <div>
          <mat-toolbar class="mat-accent m-0">
            <mat-toolbar-row fxFlex fxLayout="row" fxLayoutAlign="space-between center">
              <span class="title dialog-title">Site Import Excel</span>
            </mat-toolbar-row>
          </mat-toolbar>
          <div class="p-20 m-20">
            <div fxLayout="row" style="padding:10px;">
              <div class="w-100-p" fxLayoutAlign="center center">
                <input id="fileToUpload" type="file" (click)="removeerrormgs()" #file (change)="selectFile(file.files)" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                <a href="/assets/template/SiteImportTemplate.xlsx" download="SiteImportTemplate.xlsx" class="text-right">Download Template</a>&nbsp;&nbsp;
                <mat-icon class="mat-icon material-icons " role="img" aria-hidden="true">archive</mat-icon>
              </div>
            </div>

            <div fxLayout="row" style="padding:10px;" *ngIf="isError">
              <div class="w-100-p" fxLayoutAlign="center center">
                <mat-error>* {{errorMsg}}</mat-error>
              </div>
            </div>
            <div class="form-hazard-creation-btn" fxLayoutAlign="center center" style="padding:10px;margin:15px 35px 0px 0px;">
              <button mat-raised-button color="accent" class="submit-button" [disabled]="isErrordisable" (click)="importSite()">Submit</button>
            </div>
            <mat-tab-group *ngIf="response">
              <mat-tab label="Success ({{response.success.length}})">
                <br>
                <h3 *ngIf="response.success.length>0">{{response.success.length}} rows successfully imported!</h3>
                <h3 *ngIf="response.success.length === 0">No site imported! Please check error tab for details</h3>
              </mat-tab>
              <mat-tab label="Errors ({{response.error.length}})">
                <br>
                <h3 *ngIf="response.error.length === 0">No error!</h3>
                <div *ngFor="let err of response.error">
                  <div class="mat-elevation-z4" style="background-color: #ebecf0;">
                    <p style="overflow-wrap: break-word;">{{err.values}}</p>
                    <mat-error>* {{err.error.originalError.info.message}}</mat-error>
                  </div>
                  <br>
                </div>
              </mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </form>
    </div>
  </div> 

  <!-- <div>
    <div>
      <form class="mat-elevation-z4 m-20">
        <div>
          <mat-toolbar class="mat-accent m-0">
            <mat-toolbar-row fxFlex fxLayout="row" fxLayoutAlign="space-between center">
              <span class="title dialog-title">Hazard Import Excel</span>
            </mat-toolbar-row>
          </mat-toolbar>
          <div class="p-20 m-20">
            <div fxLayout="row" style="padding:10px;">
              <div class="w-100-p" fxLayoutAlign="center center">
                <input id="fileToUploadHaz" type="file" (click)="removeerrormgsHaz()" #fileHaz (change)="selectFileHaz(fileHaz.files)" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                <a href="/assets/template/HazardImportTemplate.xlsx" download="HazardImportTemplate.xlsx" class="text-right">Download Hazard Template</a>&nbsp;&nbsp;
                <mat-icon class="mat-icon material-icons " role="img" aria-hidden="true">archive</mat-icon>
              </div>
            </div>

            <div fxLayout="row" style="padding:10px;" *ngIf="isErrorHaz">
              <div class="w-100-p" fxLayoutAlign="center center">
                <mat-error>* {{errorMsgHaz}}</mat-error>
              </div>
            </div>
            <div class="form-hazard-creation-btn" fxLayoutAlign="center center" style="padding:10px;margin:15px 35px 0px 0px;">
              <button mat-raised-button color="accent" class="submit-button" [disabled]="isErrordisableHaz" (click)="importHazard()">Submit</button>
            </div>
            <mat-tab-group *ngIf="responseHaz">
              <mat-tab label="Success ({{responseHaz.success.length}})">
                <br>
                <h3 *ngIf="responseHaz.success.length>0">{{responseHaz.success.length}} rows successfully imported!</h3>
                <h3 *ngIf="responseHaz.success.length === 0">No hazard imported! Please check error tab for details</h3>
              </mat-tab>
              <mat-tab label="Errors ({{responseHaz.error.length}})">
                <br>
                <h3 *ngIf="responseHaz.error.length === 0">No error!</h3>
                <div *ngFor="let err of responseHaz.error">
                  <div class="mat-elevation-z4" style="background-color: #ebecf0;">
                    <p style="overflow-wrap: break-word;">{{err.values}}</p>
                    <mat-error>* {{err.error.originalError.info.message}}</mat-error>
                  </div>
                  <br>
                </div>
              </mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </form>
    </div>
  </div> -->
</div>